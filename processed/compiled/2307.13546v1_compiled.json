{
  "metadata": {
    "title": "Transfer Learning for Portfolio Optimization",
    "authors": [
      "Haoyang Cao",
      "Haotian Gu",
      "Xin Guo",
      "Mathieu Rosenbaum"
    ],
    "abstract": "In this work, we explore the possibility of utilizing transfer learning techniques to address the financial portfolio optimization problem. We introduce a novel concept called \"transfer risk\", within the optimization framework of transfer learning. A series of numerical experiments are conducted from three categories: cross-continent transfer, cross-sector transfer, and cross-frequency transfer. In particular, 1. a strong correlation between the transfer risk and the overall performance of transfer learning methods is established, underscoring the significance of transfer risk as a viable indicator of \"transferability\"; 2. transfer risk is shown to provide a computationally efficient way to identify appropriate source tasks in transfer learning, enhancing the efficiency and effectiveness of the transfer learning approach; 3. additionally, the numerical experiments offer valuable new insights for portfolio management across these different settings.",
    "published": "",
    "arxiv_id": "2307.13546v1",
    "categories": [
      "q-fin.PM",
      "cs.LG"
    ],
    "pdf_url": "http://arxiv.org/pdf/2307.13546v1",
    "pdf_file": "data/pdfs/2307.13546v1.pdf",
    "pdf_filename": "2307.13546v1.pdf"
  },
  "processing_info": {
    "processed_at": "2025-10-28T10:16:25.281796",
    "sections_found": 35,
    "tables_found": 0,
    "images_found": 13
  },
  "sections_text": {
    "Transfer Learning for Portfolio Optimization": "Haoyang Cao ∗ Haotian Gu † Xin Guo ‡ Mathieu Rosenbaum §",
    "Abstract": "In this work, we explore the possibility of utilizing transfer learning techniques to address the financial portfolio optimization problem. We introduce a novel concept called “transfer risk”, within the optimization framework of transfer learning. A series of numerical experiments are conducted from three categories: cross-continent transfer, cross-sector transfer, and cross- frequency transfer. In particular, 1. a strong correlation between the transfer risk and the overall performance of transfer learning methods is established, underscoring the significance of transfer risk as a viable indicator of “transferability”; 2. transfer risk is shown to provide a computationally efficient way to identify appropriate source tasks in transfer learning, enhancing the efficiency and effectiveness of the transfer learning approach; 3. additionally, the numerical experiments offer valuable new insights for portfolio management across these different settings.",
    "Transfer Learning": "Transfer learning is built upon the fundamental principle that knowledge gained from solving one problem can be transferred and applied to effectively solve a different but related problem. As a powerful technique in machine learning, it has attracted considerable attention and showcased re- markable potential across various domains, including natural language processing [ Ruder et al., 2019 , Devlin et al., 2019 , Sung et al., 2022 ], sentiment analysis [ Jiang and Zhai, 2007 , Deng et al., 2013 , Liu et al., 2019 ], computer vision [ Deng et al., 2009 , Long et al., 2015 , Ganin et al., 2016 , Wang and Deng, 2018 ], activity recognition [ Cook et al., 2013 , Wang et al., 2018 ], medical data analysis [ Zeng et al., 2019 , Wang et al., 2022 , Kim et al., 2022 ], and bio-informatics [ Hwang and Kuang, 2010 ]. It is also one of the backbones for large language models such as the GPT-series [ Ouyang et al., 2022 , OpenAI, 2023 ]. See also review papers [ Pan and Yang, 2010 , Tan et al., 2018 , Zhuang et al., 2020 ]. Apart from the above practical adoption of transfer learning, there has been a line of work dedicating to its theoretical aspects. Some of them tend to focus on specific learning problems, such as classification, and derive upper bounds of generalization error under different measure- ments. There are the VC-dimension of the hypothesis space adopted in [ Blitzer et al., 2007 ], total variation distance in [ Ben-David et al., 2010 ], f -divergence in [ Harremoës and Vajda, 2011 ], Jensen- Shannon divergence in [ Zhao et al., 2019 ], H -score in [ Bao et al., 2019 ], mutual information in [ Bu et al., 2020 ], and more recently X 2 -divergence in [ Tong et al., 2021 ], and variations of optimal ∗ Centre de Mathématiques Appliquées, Ecole Polytechnique. Email: haoyang.cao@polytechnique.edu",
    "† Department of Mathematics, UC Berkeley. Email: haotian_gu@berkeley.edu": "‡ Department of Industrial Engineering & Operations Research, UC Berkeley. Email: xinguo@berkeley.edu § Centre de Mathématiques Appliquées, Ecole Polytechnique. Email: mathieu.rosenbaum@polytechnique.edu 1",
    "arXiv:2307.13546v1  [q-fin.PM]  25 Jul 2023": "transport cost in [ Tan et al., 2021 ]. Others interpret transferability for transfer learning as a mea- surement of similarity between the source and the target data using various divergences, such as low- rank common information in [ Saenko et al., 2010 ], KL-divergence in [ Ganin and Lempitsky, 2015 , Ganin et al., 2016 , Tzeng et al., 2017 ], l 2 -distance in [ Long et al., 2014 ], and the optimal transport cost in [ Courty et al., 2017 ].",
    "Transfer Learning in Finance": "In the realm of finance, limited data availability or excessive noise can hinder practitioners from accomplishing tasks such as equity fund recommendation [ Zhang et al., 2018 ] and stock price pre- diction [ Wu et al., 2022 ]. Under this circumstance, transfer learning offers a promising avenue for overcoming data constraints and improving predictive models. Instead of starting from scratch for each specific task, transfer learning allows financial practitioners to capitalize on the knowledge and patterns accumulated from analogous tasks or domains. By transferring the knowledge, models can effectively learn from past experiences and generalize to new situations, resulting in more accurate predictions and enhanced decision-making capabilities. For instance, in [ Zhang et al., 2018 ], the investment strategy gained from the stock market is transferred to the equity market where data are unconventional in order to facilitate personalized investment recommendation. In [ Leal et al., 2022 ], to overcome the scarcity of training data in high frequency trading, the deep learning model designed for trading strategy generation is first pretrained over simulated data before fine-tuning over genuine historical trading trajectories. In [ Wu et al., 2022 ], to improve the accuracy of stock prediction, the knowledge of industrial chain information is transferred to the prediction model. In fact, to assist in stock and market prediction, there has been a stream of work utilizing the advances in natural language processing to extract useful information from financial text. One such example would be FinBERT [ Liu et al., 2021 ], a financial text mining variant of the BERT model. For more examples and details, see survey papers on natural language based financial forecasting such as [ Xing et al., 2018 ]. Transfer learning techniques can also be applied to other applications of finance and economics including credit risk management [ Lebichot et al., 2020 ], model calibration [ Rosenbaum and Zhang, 2021 ], and crude oil price prediction [ Cen and Wang, 2019 ].",
    "Our Work": "In this work, we will apply transfer learning techniques to the portfolio optimization problem. Moreover, we will introduce a new concept called transfer risk within the optimization framework for transfer learning established in [ Cao et al., 2023 ], and demonstrate its connection with the learning outcome via different numerical experiments. Numerical evidence shows a strong correlation between the transfer risk and the overall performance of transfer learning methods, indicating the significance of transfer risk as a viable indicator of the transferability. Moreover, it shows that transfer risk provides a computationally efficient way to identify appropriate source tasks in transfer learning, enhancing the efficiency and effectiveness of the transfer learning approach. For the experiments, we test the performance of transfer learning and transfer risk under three tasks, namely, cross-continent transfer, which is transferring a portfolio from the US equity market to the other equity markets, cross-sector transfer, which is transferring a portfolio from the one sector to other sectors, and cross-frequency transfer, which is transferring a low-frequency portfolio to the mid-frequency domain. The numerical experiments offer valuable insights into the potential of transfer learning across these different settings. • In the cross-continent transfer, our study shows different performance for different international market. For instance, transfer learning from the US market outperforms direct learning in 2 certain European markets such as Germany, but it performs relatively poor for the Brazil market. This suggest that Germany market is a better candidate as a transfer target than the Brazil market. • For the cross-sector transfer, we analyze the performance differences among sectors, and discuss the underlying factors. For instance, our analysis reveals that transfer risks in Health Care and Information Technology sectors display large negative correlations. In contrast, correlations are not significant for Utilities and Real Estate, potentially due to factors not fully captured by transfer risk. • Regarding the cross-frequency transfer, our results indicate that transferring a low-frequency portfolio (one-day) to higher frequencies (intraday) carries high transfer risks with poor performances. In contrast, transferring within the mid to high-frequency regime yields more robust and promising outcomes.",
    "Paper outline": "In Section 2 , we will formally define the transfer learning framework of the financial portfolio optimization problem. Based on this optimization framework, we will define a new concept called transfer risk to provide an apriori estimate on the final learning outcome. In Section 3 , we will state the settings for the numerical tests and present corresponding results and implications. Finally, we conclude this work by Section 4 .",
    "Problems": "In many cases such as managing portfolios in new emerging markets, there are limited data for directly estimating the mean return and covariance matrix for a set of portfolio, resulting in large estimation error and non-robust portfolio. We will show that transferring knowledge from portfolios of a mature market could be a natural and viable way to tackle this problem. The basic idea of transfer learning is simple: it is to leverage knowledge from a well-studied portfolio optimization problem in a mature market, known as the source task, to improve the performance of a new portfolio optimization problem in the emerging market with similar features, known as the target task. In particular, we will consider three types of portfolio transfers: 1. Cross-continent transfer: This refers to the case when one transfers a portfolio from the equity market in one country to the equity market in another, e.g., from the US equity market to the Brazil equity market. In general, the source market has more historical data or more diverse stocks than the target market, which may provide the target market with a robust pre-trained portfolio. The study of cross-continent transfer aims to understand how continental discrepancy affects the performance of transfer learning. 2. Cross-sector transfer: This refers to the case when one transfers a portfolio from one sector of a market to another sector, e.g., from Information Technology sector to Health Care sector in the US equity market. The study of cross-sector transfer aims to understand correlations between various sectors in the market, and how correlations between sectors affect the performance of transfer learning. 3 3. Cross-frequency transfer: This refers to the case when one transfers a portfolio constructed under one trading frequency to another trading frequency, e.g., from low-frequency trading to mid or high-frequency trading. The study of cross-frequency transfer aims to explore the possibility of transferring the portfolio across different trading frequencies, which has important and practical implications for institutional investors.",
    "Mathematical Setup": "First, let us start by considering a capital market consisting of d assets whose annualized returns are captured by the random vector r = ( r 1 , ..., r d ) ⊤ ∼ P . A portfolio allocation vector ϕ = ( ϕ 1 , ..., ϕ d ) ⊤ is a d -dimensional vector in the unit simplex X := { ϕ ∈ R d + : P d j =1 ϕ j = 1 } with ϕ i percentage of the available capital invested in asset i for each i = 1 , ..., d . The annualized return of a portfolio ϕ is given by ϕ ⊤ r. Recall that the optimal portfolio problem is to find the highest Sharpe ratio from solving the following optimization problem: b ϕ = arg max ϕ ∈ X E P [ ϕ ⊤ r ] Var ( ϕ ⊤ r ) = arg max ϕ ∈ X µ ⊤ P ϕ ϕ ⊤ Σ P ϕ , (1) where µ P is the expectation and Σ P is the covariance matrix of the return r . Empirically, µ P and Σ P are estimated from the historical return. Next, we will denote the source task as S and target task as T for the problem of portfolio optimization, and assume that the source and target tasks S and T share the same input and output spaces denoted by X S = X T = R d and Y S = Y T = R . Note that different from other financial machine learning problems, such as return prediction, there is no sample from the output space that is explicitly observed. Instead, one can only get historical stock returns as input data. Meanwhile, a portfolio vector ϕ can be viewed as a linear mapping from R d to R , taking a d -dimensional stock return to a portfolio return. More specifically, the admissible sets of source and target models are restricted to: A S = A T = { f : R d → R | f ( r ) = ϕ ⊤ r for some ϕ ∈ X } . In addition, for the source task, the loss functional is set to be the negative Sharpe ratio, and consequently, the source task is to solve following the optimization problem: c ϕ S = arg max ϕ ∈ X µ ⊤ S ϕ p ϕ ⊤ Σ S ϕ , (2) where µ S and Σ S are the mean and covariance estimations from the source data set. By the transfer learning approach, we will transfer the portfolio optimization problem from the source task to the target task via solving the following optimization with a L 2 regularization term penalizing the distance between the pre-trained portfolio and the transferred portfolio: c ϕ T = arg max ϕ ∈ X µ ⊤ T ϕ p ϕ ⊤ Σ T ϕ − λ c ϕ S − ϕ 2 2 . (3) Here µ T and Σ T are the mean and covariance estimations from the target data, and λ > 0 is a hyper-parameter controls the power of the regularization: the higher λ is, the closer the transferred portfolio c ϕ T will be to the pre-trained portfolio c ϕ S . In fact, ( 3 ) is equivalent to searching an output transport mapping T Y over the linear function space A T = { f : R d → R | f ( r ) = ϕ ⊤ r for some ϕ ∈ X } , while the loss functional takes the form of negative Sharpe ratio in addition to a regularization on the l 2 distance from the source model c ϕ S . The whole procedure of the portfolio transfer is summarized in Figure 1 . 4 Figure 1: Procedure of portfolio transfer. To assess the risk of transfer learning in the portfolio optimization problem, we will devise a risk metric called transfer risk denoted by R trans . It encompasses two aspects we take into consideration, namely the “quality” and the “relevance” of the chosen source portfolio. That is, the transfer risk R trans is expressed as R trans = R 1 + R 2 . (4) Here R 1 concerns with the performance of the source portfolio, and is defined as R 1 =   µ ⊤ S c ϕ S q c ϕ S ⊤ Σ S c ϕ S   − 1 . (5) This expression is inversely proportional to the Sharpe ratio of the source task, and it serves as a measure of risk associated with selecting a source task that exhibits poor portfolio performance. The second component R 2 measures the similarity between the source and target portfolios in terms of their data distributions. More specifically, it approximate the return distributions of the source and target tasks using mean and covariance estimates ( µ S , Σ S ) and ( µ T , Σ T ) , respectively, and model these distributions as multivariate normal distributions N ( µ S , Σ S ) and N ( µ T , Σ T ) . Consequently, R 2 is defined as the Wasserstein-2 distance between these two distributions: R 2 = W 2 ( N ( µ S , Σ S ) , N ( µ T , Σ T )) . (6)",
    "Experimental Settings and Results": "Throughout the experiments, we test the performance of transfer learning and transfer risk under various portfolio optimization problems, including cross-continent transfer, cross-sector transfer, and cross-frequency transfer.",
    "Cross-Continent Transfer.": "In these numerical experiments, the source market is defined as the US equity market, while the target markets are chosen to be United Kingdom, Brazil, Germany, and Singapore, in four separate 5 experiments respectively. Our findings indicate that transfer learning is more likely to outperform direct learning in European markets, such as Germany, while its performance is comparatively worse in the Brazil market. Notably, we observe a strong correlation between transfer risk and the transfer learning performance across all the different markets. Given a target market, we first select out the top ten stocks with the largest market capitals ( d = 10 ) as the class of target assets. Then, ten stocks will be randomly selected from the S&P500 component stocks as the class of source assets. Three data sets will be constructed accordingly: 1. Source training data : it consists of the daily returns of ten source assets, from February 2000 to February 2020. 2. Target training data : it consists of the daily returns of ten target assets, from February 2015 to February 2020. 3. Target testing data : it consists of the daily returns of ten target assets, from February 2020 to September 2021. We compare direct learning with transfer learning: for direct learning, the portfolio is directly learned by solving ( 1 ) , with mean and covariance estimated from target training data; for transfer learning, the portfolio is first pre-trained on the source training data by solving ( 2 ) , then fine-tuned on the target training data by solving ( 3 ) . Finally, the performances of those methods are evaluated through their Sharpe ratios on the target testing data. The regularization parameter λ in ( 3 ) is set to be 0 . 2 . Meanwhile, we also compute the transfer risk following the method described in Section 2.2 , using the source training data and target testing data. For each target market, the results across one thousand random experiments (randomness in selections of source assets) are plotted in Figure 2 .",
    "Correlation": "-0.66 -0.67 -0.64 -0.62 Table 1: Correlation between risk and Sharpe ratio for transfer from the US market to other markets. Across those four markets, a consistent pattern is observed: the transfer risk is significantly correlated with the Sharpe ratio of the transferred portfolio (with correlation around -0.60), as shown in Table 1 . This observation supports the idea of using transfer risk as a measurement for the transferability of a task. Meanwhile, the performance of transfer learning is compared with that of direct learning in Figure 2 . For each target market, the dashed green line indicates the direct learning performance. The blue dots above the green line represent transfer learning tasks that outperform the direct learning. Note that for all four target markets, there are a significant amount of transfer learning tasks outshining the direct learning, especially for those tasks achieving low transfer risk. As shown in Figure 2 , transfer learning is more likely to outperform direct learning in European markets, such as Germany, while it performs worse in the Brazil market. A possible interpretation to this finding is that European markets have tighter connections and higher similarities with the US market, which help to boost the performance of transfer learning.",
    "Cross-Sector Transfer.": "In this numerical experiment, we focus on transfer learning among ten different sectors in the US equity market: Communication Services, Consumer Discretionary, Energy, Financials, Health Care, 6 (a) US → UK (b) US → Brazil (c) US → Germany (d) US → Singapore Figure 2: Sharpe ratio and transfer risk when transferring from the US market to other markets. Industrials, Information Technology, Materials, Real Estate, and Utilities. We conduct two separate experiments, one with S&P500 stocks and the other with non-S&P500 stocks, to compare the differences in transfer learning performance and transfer risk. The analysis reveals that transfer risks in Health Care and Information Technology sectors display large negative correlations with transfer learning outcomes, effectively characterizing transferability in these sectors. In contrast, correlations are not significant for Utilities and Real Estate, potentially due to factors not fully captured by transfer risk. Additionally, for some sectors such as Energy, the correlations become more significant within non-S&P500 stocks than S&P500 stocks. More specifically, given a source sector and a target sector, we first randomly sample ten stocks ( d = 10 ) from each sector, as the source asset class and target asset class. Then, three data sets will be constructed accordingly: 1. Source training data : it consists of the daily returns of ten stocks from a given source sector, from February 2000 to February 2020. 2. Target training data : it consists of the daily returns of ten stocks from a given target sector, from February 2015 to February 2020. 3. Target testing data : it consists of the daily returns of ten stocks from a given target sector, from February 2020 to September 2021. The transfer learning scheme applied in the experiments is same as before: the portfolio is first pre-trained on the source training data by solving ( 2 ) , then fine-tuned on the target training data 7 Figure 3: Transfer risk and Sharpe ratio, transferring to Health Care sector in S&P500 stocks. by solving ( 3 ) . Finally, the performance of the portfolio is evaluated through its Sharpe ratio on the target testing data. The regularization parameter λ in ( 3 ) is set to be 0 . 2 . Meanwhile, the computation of transfer risk follows the approach described in Section 2.2 , using the source training data and target testing data. For each source-target sector pair (in total 10 × 10 = 100 pairs), five hundred random experiments with different stock selections are conducted, and we record the average Sharpe ratio and average transfer risk of those random experiments. The results are presented in Figure 3 , Figure 4 , Figure 5 and Table 2 . Figure 3 shows the relation between (average) Sharpe ratios and (average) scores when transferring portfolios from various source sectors to the target Health Care sector. In general, the negative correlation between Sharpe ratios and scores is observed: when the target sector is fixed (Health Care in this example), transferring a portfolio from a source sector with lower transfer risk is more likely to achieve a higher Sharpe ratio. In particular, Information Technology, Health Care, and Consumer Discretionary are desirable source sectors when the target sector is Health Care, while Energy is not a suitable choice. In Figure 4 and Figure 5 , we plot the heat maps of transfer risks and Sharpe ratios when transferring across all sectors. Here the transfer risks and Sharpe ratios are rescaled linearly so that for each target sector, the values will range from zero to one, where zero (resp. one) is for the source sector with the lowest (resp. highest) transfer risk or Sharpe ratio. Meanwhile, for experiments in Figure 4 , the source and target stocks are all sampled from S&P500 components, while for Figure 5 , the source stocks are sampled from stocks not listed in the S&P500 Index (and the target stocks are still sampled from S&P500 components). Table 2 records the correlation between Sharpe ratios and transfer risks when transferring portfolios from various source sectors to each target sector. Lower correlation implies that the target sector may benefit more from transfer learning and the transferability is better captured by transfer risk. Similar as the setting in Figure 4 and Figure 4 , Table 2a is from the experiments using S&P500 source stocks, while Table 2b is from the experiments using non-S&P500 source stocks. Several insightful patterns are observed from above. For sectors such as Health Care and Information Technology, large negative correlations are revealed in Table 2 , no matter whether the 8 (a) Risk for cross-sector transfer. (b) Sharpe ratio for cross-sector transfer. Figure 4: Relative risk and Sharpe ratio for transfer across sectors with S&P500 stocks. stocks are chosen from S&P500 or not. This implies that the transfer risk appropriately encodes the statistical property and characterizes the transferability of portfolios in those sectors. On the contrary, for sectors such as Utilities and Real Estate, the correlations shown in Table 2 are not significant, regardless of whether the stocks are chosen from S&P500 or not. This may result from the fact that companies in Utilities and Real Estate sectors tend to be affected by underlying spatial factors and also changes in regulatory policies. Those aspects may not be fully captured by the transfer risk. In addition, for Energy sector, the correlation is more significant when considering non-S&P500 stocks. This may due to the industry concentration of Energy sector in S&P500 Index: Energy sector in S&P500 Index is highly concentrated to a few large companies, and the portfolio’s performance is largely driven by some company-specific factors which the transfer risk fails to capture. The effect of industry concentration dwindles when non-S&P500 stocks are considered.",
    "Cross-Frequency Transfer.": "In the following numerical experiments, we focus on transfer learning between different trading frequencies, ranging from mid-frequency to low-frequency: 1-minute, 5-minute, 10-minute, 30-minute, 65-minute, 130-minute and 1-day. The findings demonstrate that transferring a low-frequency portfolio (1-day) to higher frequencies results in relatively high transfer risks and poor transfer learning performances. This discrepancy arises from the distinct statistical properties of intraday price movements in mid/high-frequency trading compared to cross-day price movements in low- frequency trading, affecting the transfer process. Conversely, within the mid/high-frequency regime (1-minute to 130-minute), the study reveals that 65-minute and 130-minute frequencies serve as better candidates for the source frequency due to more robust mean and covariance estimations. Consequently, these frequencies lead to improved transfer learning performance after fine-tuning. More specifically, given a source frequency and a target frequency, we first randomly sample ten stocks ( d = 10 ) from the fifty largest US companies by market capitalization. Then, three data sets will be constructed accordingly: 1. Source training data : it consists of the returns of ten stocks, sampled under a given source frequency, from February 2016 to September 2019. 9 (a) Risk for cross-sector transfer. (b) Sharpe ratio for cross-sector transfer. Figure 5: Relative risk and Sharpe ratio for transfer across sectors with non-S&P500 stocks. 2. Target training data : it consists of the returns of ten stocks, sampled under a given target frequency, from February 2016 to September 2019. 3. Target testing data : it consists of the returns of ten stocks, sampled under a given target frequency, from September 2019 to February 2020. The transfer learning scheme applied in the experiments is the same as before: the portfolio is first pre-trained by solving ( 2 ) with the mean and covariance estimated from the source-frequency training data, then fine-tuned by solving ( 3 ) with the mean and covariance estimated from the target-frequency training data. Meanwhile, following the usual setting in mid/high-frequency trading, we assume that over-night holding is not allowed for trading frequencies ranging from 1-minute to 130-minute. More specifically, when over-night holding not is allowed, the price movement after the market close and before the market open will not be included in the mean and covariance estimation. Finally, the performance of the portfolio is evaluated through its Sharpe ratio on the target-frequency testing data. The regularization parameter λ in ( 3 ) is set to be 0 . 2 . Meanwhile, the computation of transfer risk follows the approach described in Section 2.2 , using the source-frequency training data and target-frequency testing data. For each source-target frequency pair (in total 7 × 17 = 49 pairs), two hundred random experiments with different stock selections are conducted, and we record the average Sharpe ratio and average transfer risk of those random experiments. The results are presented in Figure 6 , Figure 7 and Table 3 . For example, Figure 6 shows the relation between (average) Sharpe ratios and (average) transfer risks when transferring portfolios from various source frequencies to the target frequency of 130- minute. In general, the negative correlation between Sharpe ratios and scores is observed: when the target frequency is fixed (130-minute in this example), transferring a portfolio from a source frequency with lower transfer risk corresponds to a higher Sharpe ratio. In particular, source frequencies such as 130-minute and 65-minute, which are closer to the 130-minute target frequency, are desirable source tasks, while 1-minute or 1-day is less suitable. To see more clearly the relation between different frequencies, in Figure 7 , we plot the heat maps of transfer risks and Sharpe ratios when transferring across all frequencies. Here the transfer risks 10",
    "Health Care": "-0.47",
    "Communication": "-0.46",
    "Materials": "-0.49",
    "IT": "-0.67",
    "Financials": "0.10",
    "Consumer": "-0.28",
    "Industrials": "-0.30",
    "Real Estate": "-0.14",
    "Utilities": "0.17 (b) Non-S&P500 stocks. Table 2: Correlation between risk and Sharpe ratio for transfer from other sectors to the target. and Sharpe ratios are again rescaled linearly, so that for each target frequency, the values will range from zero to one. Meanwhile, Table 3 records the correlation between Sharpe ratios and transfer risks when transferring portfolios from various source frequencies to each target frequency, following the same setting as Figure 7 .",
    "Energy": "-0.40",
    "1 min": "-0.59",
    "5 min": "-0.70",
    "10 min": "-0.74",
    "30 min": "-0.59",
    "65 min": "-0.70",
    "130 min": "-0.76",
    "Day": "-0.19 Table 3: Correlation between risk and Sharpe ratio for transfer from other frequency to the target. From Figure 7 , it is observed that the transfer risks from 1-day frequency to other higher frequencies are relatively high, resulting in poor transfer learning performances as well. This demonstrates a natural discrepancy between low-frequency trading and mid/high-frequency trading: mid/high-frequency trading aims to capture intraday stock price movements by not allowing over- night holding, while low-frequency trading intends to capture price movements across trading days. Consequently, the difference between the underlying statistical properties of intraday price movements and cross-day price movements hurts the performance of transferring a low-frequency portfolio to a mid/high-frequency portfolio. Meanwhile, for transfer learning inside the mid/high-frequency regime (1-minute to 130-minute), the results in Figure 7 reveal that 65-minute and 130-minute are more appropriate candidates for the source frequency, since they lead to much better transfer learning performance, compared to other higher source frequencies. This may due to the fact that under 65-minute and 130-minute frequencies, the mean and covariance estimations are more robust, hence resulting in a robust source portfolio which performs well after fine-tuning. 11 Figure 6: Transfer risk and Sharpe ratio, transferring to 130-minute frequency.",
    "Significance": "In this work, we have demonstrated how to apply transfer learning techniques to solve portfolio optimization problems by leveraging knowledge obtained from well-established portfolios. We have also shown that prior to starting a full-scale transfer learning scheme, transfer risk is an easy-to- compute and viable quantity as a prior estimate of the final learning outcome. By presenting these compelling results, we provide valuable insights into the potential of transfer learning in solving financial problems, with transfer risk as a pivotal component for successful implementation.",
    "References": "[Bao et al., 2019] Bao, Y., Li, Y., Huang, S.-L., Zhang, L., Zheng, L., Zamir, A., and Guibas, L. (2019). An information-theoretic approach to transferability in task transfer learning. In 2019 IEEE International Conference on Image Processing , pages 2309–2313. IEEE. [Ben-David et al., 2010] Ben-David, S., Blitzer, J., Crammer, K., Kulesza, A., Pereira, F., and Vaughan, J. W. (2010). A theory of learning from different domains. Machine learning , 79(1):151– 175. [Blitzer et al., 2007] Blitzer, J., Crammer, K., Kulesza, A., Pereira, F., and Wortman, J. (2007). Learning bounds for domain adaptation. In Proceedings of the 20th International Conference on Neural Information Processing Systems , volume 20, page 129–136. Curran Associates Inc. [Bu et al., 2020] Bu, Y., Zou, S., and Veeravalli, V. V. (2020). Tightening mutual information- based bounds on generalization error. IEEE Journal on Selected Areas in Information Theory , 1(1):121–130. [Cao et al., 2023] Cao, H., Gu, H., Guo, X., and Rosenbaum, M. (2023). Feasibility and transfer- ability of transfer learning: A mathematical framework. arXiv preprint arXiv:2301.11542 . 12 (a) Risk for cross-frequency transfer. (b) Sharpe ratio for cross-frequency transfer. Figure 7: Relative risk and Sharpe ratio for transfer across frequencies. [Cen and Wang, 2019] Cen, Z. and Wang, J. (2019). Crude oil price prediction model with long short term memory deep learning based on prior knowledge data transfer. Energy , 169:160–171. [Cook et al., 2013] Cook, D., Feuz, K. D., and Krishnan, N. C. (2013). Transfer learning for activity recognition: A survey. Knowledge and Information Systems , 36:537–556. [Courty et al., 2017] Courty, N., Flamary, R., Tuia, D., and Rakotomamonjy, A. (2017). Optimal transport for domain adaptation. IEEE Transactions on Pattern Analysis and Machine Intelligence , 39(9):1853–1865. [Deng et al., 2009] Deng, J., Dong, W., Socher, R., Li, L.-J., Li, K., and Fei-Fei, L. (2009). ImageNet: A large-scale hierarchical image database. In Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition , pages 248–255. IEEE. [Deng et al., 2013] Deng, J., Zhang, Z., Marchi, E., and Schuller, B. (2013). Sparse autoencoder- based feature transfer learning for speech emotion recognition. In Proceedings of the 2013 Humaine Association Conference on Affective Computing and Intelligent Interaction , pages 511–516. IEEE. [Devlin et al., 2019] Devlin, J., Chang, M.-W., Lee, K., and Toutanova, K. (2019). BERT: Pre- training of deep bidirectional transformers for language understanding. In Proceedings of the",
    "Conference of the North American Chapter of the Association for Computational Linguis-": "tics: Human Language Technologies , volume 1, pages 4171–4186. Association for Computational Linguistics. [Ganin and Lempitsky, 2015] Ganin, Y. and Lempitsky, V. (2015). Unsupervised domain adaptation by backpropagation. In Proceedings of the 32nd International Conference on Machine Learning , volume 37, pages 1180–1189. PMLR. [Ganin et al., 2016] Ganin, Y., Ustinova, E., Ajakan, H., Germain, P., Larochelle, H., Laviolette, F., Marchand, M., and Lempitsky, V. (2016). Domain-adversarial training of neural networks. Journal of Machine Learning Research , 17(59):1–35. 13 [Harremoës and Vajda, 2011] Harremoës, P. and Vajda, I. (2011). On pairs of f -divergences and their joint range. IEEE Transactions on Information Theory , 57(6):3230–3235. [Hwang and Kuang, 2010] Hwang, T. and Kuang, R. (2010). A heterogeneous label propagation algorithm for disease gene discovery. In Proceedings of the 2010 SIAM International Conference on Data Mining , pages 583–594. SIAM. [Jiang and Zhai, 2007] Jiang, J. and Zhai, C. (2007). Instance weighting for domain adaptation in nlp. In Proceedings of the 45th Annual Meeting of the Association of Computational Linguistics , pages 264–271. [Kim et al., 2022] Kim, H. E., Cosa-Linan, A., Santhanam, N., Jannesari, M., Maros, M. E., and Ganslandt, T. (2022). Transfer learning for medical image classification: A literature review. BMC Medical Imaging , 22(1):69. [Leal et al., 2022] Leal, L., Laurière, M., and Lehalle, C.-A. (2022). Learning a functional control for high-frequency finance. Quantitative Finance , 22(11):1973–1987. [Lebichot et al., 2020] Lebichot, B., Le Borgne, Y.-A., He-Guelton, L., Oblé, F., and Bontempi, G. (2020). Deep-learning domain adaptation techniques for credit cards fraud detection. In Recent Advances in Big Data and Deep Learning: Proceedings of the 2019 INNS Big Data and Deep Learning Conference , pages 78–88. Springer. [Liu et al., 2019] Liu, R., Shi, Y., Ji, C., and Jia, M. (2019). A survey of sentiment analysis based on transfer learning. IEEE Access , 7:85401–85412. [Liu et al., 2021] Liu, Z., Huang, D., Huang, K., Li, Z., and Zhao, J. (2021). Finbert: A pre- trained financial language representation model for financial text mining. In Proceedings of the Twenty-Ninth International Joint Conference on Artificial Intelligence , IJCAI’20. [Long et al., 2015] Long, M., Cao, Y., Wang, J., and Jordan, M. (2015). Learning transferable features with deep adaptation networks. In Proceedings of the 32nd International Conference on Machine Learning , volume 37, pages 97–105. PMLR. [Long et al., 2014] Long, M., Wang, J., Ding, G., Sun, J., and Yu, P. S. (2014). Transfer joint matching for unsupervised domain adaptation. In Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition , pages 1410–1417. IEEE. [OpenAI, 2023] OpenAI (2023). Gpt-4 technical report. [Ouyang et al., 2022] Ouyang, L., Wu, J., Jiang, X., Almeida, D., Wainwright, C., Mishkin, P., Zhang, C., Agarwal, S., Slama, K., Ray, A., et al. (2022). Training language models to follow instructions with human feedback. Advances in Neural Information Processing Systems , 35:27730– 27744. [Pan and Yang, 2010] Pan, S. J. and Yang, Q. (2010). A survey on transfer learning. IEEE Transactions on Knowledge and Data Engineering , 22(10):1345–1359. [Rosenbaum and Zhang, 2021] Rosenbaum, M. and Zhang, J. (2021). Deep calibration of the quadratic rough heston model. arXiv preprint arXiv:2107.01611 . 14 [Ruder et al., 2019] Ruder, S., Peters, M. E., Swayamdipta, S., and Wolf, T. (2019). Transfer learning in natural language processing. In Proceedings of the 2019 Conference of the North American Chapter of the Association for Computational Linguistics: Tutorials , pages 15–18. Association for Computational Linguistics. [Saenko et al., 2010] Saenko, K., Kulis, B., Fritz, M., and Darrell, T. (2010). Adapting visual category models to new domains. In Proceedings of the 11th European Conference on Computer Vision , pages 213–226. Springer. [Sung et al., 2022] Sung, Y.-L., Cho, J., and Bansal, M. (2022). Vl-adapter: Parameter-efficient transfer learning for vision-and-language tasks. In Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition , pages 5227–5237. IEEE. [Tan et al., 2018] Tan, C., Sun, F., Kong, T., Zhang, W., Yang, C., and Liu, C. (2018). A survey on deep transfer learning. In International Conference on Artificial Neural Networks , pages 270–279. Springer. [Tan et al., 2021] Tan, Y., Li, Y., and Huang, S.-L. (2021). OTCE: A transferability metric for cross-domain cross-task representations. In Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition , pages 15779–15788. IEEE. [Tong et al., 2021] Tong, X., Xu, X., Huang, S.-L., and Zheng, L. (2021). A mathematical framework for quantifying transferability in multi-source transfer learning. In Proceedings of the 35th International Conference on Neural Information Processing Systems , volume 34, pages 26103– 26116. Curran Associates, Inc. [Tzeng et al., 2017] Tzeng, E., Hoffman, J., Saenko, K., and Darrell, T. (2017). Adversarial dis- criminative domain adaptation. In Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition , pages 7167–7176. IEEE. [Wang et al., 2022] Wang, G., Kikuchi, Y., Yi, J., Zou, Q., Zhou, R., and Guo, X. (2022). Transfer learning for retinal vascular disease detection: A pilot study with diabetic retinopathy and retinopathy of prematurity. arXiv preprint arXiv:2201.01250 . [Wang et al., 2018] Wang, J., Chen, Y., Hu, L., Peng, X., and Philip, S. Y. (2018). Stratified transfer learning for cross-domain activity recognition. In Proceedings of the 2013 IEEE International Conference on Pervasive Computing and Communications , pages 1–10. IEEE. [Wang and Deng, 2018] Wang, M. and Deng, W. (2018). Deep visual domain adaptation: A survey. Neurocomputing , 312:135–153. [Wu et al., 2022] Wu, D., Wang, X., and Wu, S. (2022). Jointly modeling transfer learning of indus- trial chain information and deep learning for stock prediction. Expert Systems with Applications , 191:116257. [Xing et al., 2018] Xing, F. Z., Cambria, E., and Welsch, R. E. (2018). Natural language based financial forecasting: a survey. Artificial Intelligence Review , 50(1):49–73. [Zeng et al., 2019] Zeng, M., Li, M., Fei, Z., Yu, Y., Pan, Y., and Wang, J. (2019). Automatic icd-9 coding via deep transfer learning. Neurocomputing , 324:43–50. 15 [Zhang et al., 2018] Zhang, L., Zhang, H., and Hao, S. (2018). An equity fund recommendation system by combing transfer learning and the utility function of the prospect theory. The Journal of Finance and Data Science , 4(4):223–233. [Zhao et al., 2019] Zhao, H., Des Combes, R. T., Zhang, K., and Gordon, G. (2019). On learning in- variant representations for domain adaptation. In Proceedings of the 36th International Conference on Machine Learning , volume 97, pages 7523–7532. PMLR. [Zhuang et al., 2020] Zhuang, F., Qi, Z., Duan, K., Xi, D., Zhu, Y., Zhu, H., Xiong, H., and He, Q. (2020). A comprehensive survey on transfer learning. Proceedings of the IEEE , 109(1):43–76. 16"
  },
  "tables": [],
  "images": [
    "processed/images/2307.13546v1_page5_img0.png",
    "processed/images/2307.13546v1_page7_img0.png",
    "processed/images/2307.13546v1_page7_img1.png",
    "processed/images/2307.13546v1_page7_img2.png",
    "processed/images/2307.13546v1_page7_img3.png",
    "processed/images/2307.13546v1_page8_img0.png",
    "processed/images/2307.13546v1_page9_img0.png",
    "processed/images/2307.13546v1_page9_img1.png",
    "processed/images/2307.13546v1_page10_img0.png",
    "processed/images/2307.13546v1_page10_img1.png",
    "processed/images/2307.13546v1_page12_img0.png",
    "processed/images/2307.13546v1_page13_img0.png",
    "processed/images/2307.13546v1_page13_img1.png"
  ],
  "status": "completed"
}